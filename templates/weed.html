{% extends "sproutimport/_layouts/base" %}
{% import "_includes/forms" as forms %}

{% set title = 'Weed'|t %}

{% set hasSeeds = craft.sproutImport.hasSeeds() %}

{% block main %}

<div class="grid first" data-max-cols="3">
	<div class="item" data-position="left" data-min-colspan="2" data-max-colspan="3">
		<div id="fields" class="pane">

			{% if hasSeeds == true %}

				<table class="weed data fullwidth">
					<tr>
						<th class="type">Type</th>
						<th class="seeds">Seeds</th>
						<th class="options">&nbsp;</th>
					</tr>
					{% if elementImporters is defined %}
						{% for importer in elementImporters %}
							{% if importer.getSeedCount() > 0 %}
									<tr>
										<td>{{ importer.getName() }}</td>
										<td>{{ importer.getSeedCount() }}</td>
										<td class="options">
											<form method="post" accept-charset="UTF-8">
												{{ getCsrfInput() }}
												<input type="hidden" name="action" value="sproutImport/seed/runWeed">
												<input type="hidden" name="redirect" value="sproutimport/weed">
												<input type="hidden" name="class" value="{{ importer.getName() }}">
												<input class="btn small" name="submit" type="submit" value="Weed">
												<input class="btn small" name="submit" type="submit" value="Keep">
											</form>
										</td>
									</tr>

							{% endif %}
						{% endfor %}
					{% endif %}
				</table>

				<div class="buttons">
					<form method="post" accept-charset="UTF-8">
						{{ getCsrfInput() }}
						<input type="hidden" name="action" value="sproutImport/seed/runWeed">
						<input type="hidden" name="redirect" value="sproutimport/weed">
						<input type="hidden" name="class" value="*">
						<input class="btn submit" name="submit" type="submit" value="Weed All">
						<input class="btn" name="submit" type="submit" value="Keep All">
					</form>
				</div>

			{% else %}

				<div class="sprout-nocontent">
					<div class="sprout-mediabox-wrapper">
						<div class="sprout-mediabox">
							<img src="{{ resourceUrl('sproutimport/icon.svg') }}" alt="Sprout Logo" />
						</div>
						<div class="sprout-mediabody">
							<h2>{{ "The garden is weeded"|t }}</h2>
							<hr>
							<p>{{ "Currently, no content or settings in your database are marked as seed content. Get started and <a href='{importLink}'>import content and settings</a> or <a href='{seedLink}'>generate seed content</a>."|t({
									importLink: "#",
									seedLink: "#"
								})|raw }}</p>
						</div>
					</div>
				</div>

			{% endif %}

		</div>
	</div>
	<div class="item" data-position="right" data-colspan="1">
		<div class="pane">

			<h2>{{ "Managing seed data"|t }}</h2>

			<p>{{ "This page lists all content and settings that have been imported into your database and marked as seed data. When seed data exists, you can choose to keep or remove this data."|t }}</p>

			<h6>{{ "Weed"|t }}</h6>
			<p class="first">{{ "Select weed to remove all imported content or settings of a particular type."|t|raw }}</p>

			<h6>{{ "Keep"|t }}</h6>
			<p class="first">{{ "Select keep to unmark seed data and continue to manage it as permanent content and settings in Craft."|t|raw }}</p>

		</div>
	</div>
</div>

{% endblock %}

{% includecss %}

table.weed td:last-of-type {
	text-align: right;
}

{# Media box styles #}
.sprout-nocontent {
	display: flex;
	justify-content: center;
	margin: 2em auto;
}
.sprout-mediabox-wrapper {
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;
	align-items: center;
	align-content: space-between;
	width: 70%;
}
.sprout-mediabox {
	margin-right: 1em;
}
.sprout-mediabox img {
	height: 140px;
	opacity: .3;
	width: 140px;
}
.sprout-mediabody h2 {
	font-size: 18px;
}
.sprout-mediabody hr {
	margin: 0;
}
.sprout-mediabody a {
	font-weight: bold;
}
.sprout-mediabody {
	flex-grow: 1;
	width: 60%;
}
{% endincludecss %}